<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{:C('WEBSITE_TITLE')}</title>
    <style>
        body{
            background: #EFE8D8;
            text-align:center;
            color:#9D804B;
        }

        a:link {
            text-decoration: none;
        }
        a:visited {
            text-decoration: none;
        }
        a:hover {
            text-decoration: none;
        }
        a:active {
            text-decoration: none;
        }

        .title{
            font-size:50px;
            text-align:center;
            color:#9D804B;
        }

        .video-wrapper{
            text-align:center;
            margin-top:20px;
            margin-bottom: 20px;
        }

        .sub-title{
            font-size:20px;
            text-align:center;
            color: #ff0000;
        }

        .hide{
            display:none;
        }

        .countdown-wrapper{
            padding-top:70px;
            margin-bottom:auto;
            height:240px;
            font-size:50px;
        }

        .remain-seconds{
            margin:auto;
            font-size:70px;
            display:inline-block;
            zoom: 1;
            *display: inline;
            color:#ff0000;
        }

        .total-num-bar{
            font-size:40px;
            margin-bottom:20px;
        }

        .total-num {
            font-size: 50px;
            color: #0000ff;
            display: inline-block;
            zoom: 1;
            *display: inline;
            margin-left: 15px;
            margin-right:15px;
        }

        .stage-num-bar{
            font-size:20px;
            margin-bottom:20px;
            margin-top:20px;
        }

        .stage-label{
            font-size: 20px;
            color: #9D804B;
            display: inline-block;
            zoom: 1;
            *display: inline;
            margin-left: 15px;
            margin-right:15px;
        }

        .stage-num {
            font-size: 20px;
            color: #ff0000;
            display: inline-block;
            zoom: 1;
            *display: inline;
            margin-left: 15px;
            margin-right:15px;
        }

    </style>
</head>
<body>
<if condition="$stageGX neq null">
    <div class="title">{$stageGX.title}</div>
    <div class="stage-num-bar">
        <div class="stage-label">已完成:</div><div class="stage-num">{$stageGXTotalNum}</div>
        <div class="stage-label">未完成:</div><div class="stage-num">{$stageGXRequireNum}</div>
        <div class="stage-label">总进度:</div><div class="stage-num">{$stageGXPercent}%</div>
    </div>
<else/>
    <div id="title" class="title">{:C('WEBSITE_TITLE')}</div>
    <div class="total-num-bar">全部共修总数<div class="total-num">{$totalNum}</div></div>
</if>
<div id="sub_title" class="sub-title">（当前版本为内部测试版，部分功能正在测试中）</div>
<div>
    <div id="video_wrapper" class="video-wrapper">
        <video id=example-video width=960 height=540  class="video-js" preload="auto" poster="http://designmodo.github.io/Flat-UI/docs/assets/img/video/poster.jpg" >
            <source
                    src="http://mlztlivesz.oss-cn-shenzhen.aliyuncs.com/mlztgxtest/mlztgxtest.m3u8"
                    type="application/x-mpegURL">
        </video>

        <!--<video id="video" width="432" height="240" controls="controls" preload="preload">-->
            <!--<source src="{:C('GX_VIDEO_MP4')}" type="video/mp4">-->
            <!--<source src="{:C('GX_VIDEO_OGG')}" type="video/ogg">-->
        <!--</video>-->
    </div>
    <div id="countdown_wrapper" class="countdown-wrapper hide">
        <div>距共修开始还有&nbsp;<div id="remain_seconds" class="remain-seconds"></div>&nbsp;秒</div>
    </div>
</div>
<div>
    <div>使用手机QQ扫码下载共修APP</div>
    <img src="__PUBLIC__/Image/download_app.png">
</div>
<script src="__PUBLIC__/lib/jquery-1.7.2.min.js"></script>
<script type="text/javascript">

    (function(){

        var state = '{$state}';

        Dom = {
            video : document.getElementById("video"),
            countdownBox: $('#countdown_wrapper'),
            remainSeconds :$('#remain_seconds')
        };

        if( state == "ready" ){
            var remainSeconds = parseInt('{$countdownSeconds}');
            countDown(remainSeconds);
        }else if( state == "started" ){
            var begTime = parseInt('{$begTime}');
            playFromBegTime(begTime);
        }

        function countDown(remainSeconds){
            $('#video_wrapper').hide();
            Dom.countdownBox.show();
            var i = setInterval(function() {
                if( remainSeconds <= 0 ){
                    Dom.video.play();
                    clearInterval(i);
                    Dom.countdownBox.hide();
                    $('#video_wrapper').show();
                }else{
                    Dom.remainSeconds.html(remainSeconds);
                    remainSeconds -= 1;
                }
            }, 1000);
        }

        function playFromBegTime(begTime){
            video.play();
            video.currentTime = begTime;
        }

    })();

</script>

</body>
</html>