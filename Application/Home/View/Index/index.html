<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{:C('WEBSITE_TITLE')}</title>
    <style>
        body{
            background: #EFE8D8;
            text-align:center;
            color:#9D804B;
        }

        a:link {
            text-decoration: none;
        }
        a:visited {
            text-decoration: none;
        }
        a:hover {
            text-decoration: none;
        }
        a:active {
            text-decoration: none;
        }

        .title{
            font-size:50px;
            text-align:center;
            color:#9D804B;
        }

        .menu-button-wrapper{
            width:100%;
            height:100px;
            margin-left:auto;
            margin-right:auto;
        }

        .menu-button{
            margin-left:10px;
            margin-right:10px;
            height:30px;
            width:120px;
            padding:5px;
            border: 1px solid;
            border-radius:8px;
            font-size:25px;
            display:inline-block;
            background:#9D804B;
        }

        .menu-button a{
            color:#fff;
        }

        .video-wrapper{
            text-align:center;
            margin-top:20px;
            margin-bottom: 50px;
        }

        .sub-title{
            font-size:20px;
            text-align:center;
            color: #ff0000;
        }

        .hide{
            display:none;
        }

        .countdown-wrapper{
            height:400px;
        }

        .remain-seconds{
            margin:auto;
            font-size:50px;
        }


    </style>
</head>
<body>
<div id="top_bar" class="top-bar">
    <div><img src="__PUBLIC__/Image/logo.jpg"/></div>
    <div id="title" class="title">{:C('WEBSITE_TITLE')}</div>
    <div id="sub_title" class="sub-title">（内部测试版）</div>
</div>
<div>
    <div id="video_wrapper" class="video-wrapper">
        <video id="video" width="432" height="240" controls="controls">
            <source src="{:C('GX_VIDEO')}" type="video/mp4">
        </video>
    </div>
    <div id="countdown_wrapper" class="countdown-wrapper hide">
        <div>倒计时：</div>
        <div id="remain_seconds" class="remain-seconds"></div>
    </div>
</div>


<div class="menu-button-wrapper">
    <div class="menu-button"><a href="http://{:C('GX_YIGUI')}">共修仪轨</a></div>
    <div class="menu-button"><a href="{:U('Countin/addNum')}">共修报数</a></div>
    <div class="menu-button"><a href="{:U('Countin/counter')}">在线持咒</a></div>
    <div class="menu-button"><a href="{:U('Ranklist/todayRanklist')}">精进排行</a></div>
    <if condition="$isLogin eq 0">
        <div class="menu-button"><a href="{:U('Login/login')}">用户登录</a></div>
    <else />
        <div class="menu-button"><a href="{:U('Login/userCenter')}">个人中心</a></div>
    </if>

</div>
<script src="__PUBLIC__/lib/jquery-1.7.2.min.js"></script>
<script type="text/javascript">

    (function(){

        var state = '{$state}';

        Dom = {
            video : document.getElementById("video"),
            countdownBox: $('#countdown_wrapper'),
            remainSeconds :$('#remain_seconds')
        };

        if( state == "ready" ){
            var remainSeconds = parseInt('{$countdownSeconds}');
            countDown(remainSeconds);
        }else if( state == "started" ){
            var begTime = parseInt('{$begTime}');
            playFromBegTime(begTime);
        }

        function countDown(remainSeconds){
            $('#video_wrapper').hide();
            Dom.countdownBox.show();
            var i = setInterval(function() {
                if( remainSeconds <= 0 ){
                    Dom.video.play();
                    clearInterval(i);
                    Dom.countdownBox.hide();
                    $('#video_wrapper').show();
                }else{
                    Dom.remainSeconds.html(remainSeconds);
                    remainSeconds -= 1;
                }
            }, 1000);
        }

        function playFromBegTime(begTime){
            video.play();
            video.currentTime = begTime;
        }

    })();


//    video.currentTime = 0;
//    var i = setInterval(function() {
//        if(video.readyState > 0) {
//            var minutes = parseInt(video.duration / 60, 10);
//            var seconds = video.duration % 60;
//            // (此处可以添加代码，将分钟，秒数显示到需要的地方)
//            // ...
//            // 执行到这里，就将循环定时器清除。
//            clearInterval(i);
//        }
//    }, 200);
</script>

</body>
</html>